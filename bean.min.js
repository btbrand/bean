/*!
  * bean.js - copyright @dedfat
  * https://github.com/fat/bean
  * Follow our software http://twitter.com/dedfat
  * MIT License
  * special thanks to:
  * dean edwards: http://dean.edwards.name/
  * dperini: https://github.com/dperini/nwevents
  * the entire mootools team: github.com/mootools/mootools-core
  */
!function(a){function y(a){var b=a.relatedTarget;if(!b)return b==null;return b!=this&&b.prefix!="xul"&&!/document/.test(this.toString())&&!j(this,b)}function w(a){if(!a)return{};var b=a.type,c=a.target||a.srcElement;a.preventDefault=a.preventDefault||w.preventDefault,a.stopPropagation=a.stopPropagation||w.stopPropagation,a.target=c&&c.nodeType==3?c.parentNode:c;if(b.indexOf("key")!=-1)a.keyCode=a.which||a.keyCode;else if(/click|mouse|menu/i.test(b)){a.rightClick=a.which==3||a.button==2,a.pos={x:0,y:0};if(a.pageX||a.pageY)a.pos.x=a.pageX,a.pos.y=a.pageY;else if(a.clientX||a.clientY)a.pos.x=a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,a.pos.y=a.clientY+document.body.scrollTop+document.documentElement.scrollTop;e.test(b)&&(a.relatedTarget=a.relatedTarget||a[(b=="mouseover"?"from":"to")+"Element"])}return a}function v(a,b,c){var d=k(b),e,f;e=c?d[c]:d;for(f in e)e.hasOwnProperty(f)&&(c?s:v)(a,c||b,c?e[f]:f);return a}function u(b,c){var d,e,h,i=c.split(" ");for(h=i.length;h--;){c=i[h];var j=x.indexOf(c)>-1;if(b[f])d=document.createEvent(j?"HTMLEvents":"UIEvents"),d[j?"initEvent":"initUIEvent"](c,!0,!0,a,1),b.dispatchEvent(d);else if(b[g])j?b.fireEvent("on"+c,document.createEventObject()):b["_on"+c]++;else{var l=k(b)[c];for(e in l)l.hasOwnProperty(e)&&l[e]()}}return b}function t(a,b,c){var d,e,f=typeof b=="string",g=q,h=k(a);if(f&&/\s/.test(b)){b=b.split(" ");var i=b.length-1;while(t(a,b[i])&&i--);return a}if(!h||f&&!h[b])return a;if(typeof c=="function")g(a,b,c);else{g=b?g:t,e=f&&b,b=b?c||h[b]||b:h;for(d in b)b.hasOwnProperty(d)&&g(a,e||d,b[d])}return a}function s(a,b,c,d,e){if(typeof b=="object"&&!c)for(var f in b)b.hasOwnProperty(f)&&s(a,f,b[f]);else{var g=typeof c=="string",h=(g?c:b).split(" ");c=g?r(b,d,e):c;for(var i=h.length;i--;)p(a,h[i],c,Array.prototype.slice.call(arguments,g?4:3))}return a}function r(a,b,c){return function(d){var e=typeof a=="string"?c(a,this):a;for(var f=d.target;f&&f!=this;f=f.parentNode)for(var g=e.length;g--;)if(e[g]==f)return b.apply(f,arguments)}}function q(a,b,c){var d=k(a);if(!d||!d[b])return a;c=d[b][c._uid],delete d[b][c._uid],b=z[b]?z[b].base:b;var e=a[f]||x.indexOf(b)>-1;m(a,e?b:"propertychange",c,!1,!e&&b);return a}function p(b,c,e,g){var h=k(b),i=h[c]||(h[c]={}),j=l(e);if(i[j])return b;var p=z[c];e=p&&p.condition?o(b,e,c,p.condition):e,c=p&&p.base||c;var r=a[f]||x.indexOf(c)>-1;e=r?n(b,e,g):o(b,e,c,!1,g);if(c=="unload"){var s=e;e=function(){q(b,c,e)&&s()}}m(b,r?c:"propertychange",e,!0,!r&&!0),i[j]=e,e._uid=j;return c=="unload"?b:d[l(b)]=b}function o(a,b,c,d,e){return function(f){(d?d.call(this,f):f&&f.propertyName=="_on"+c||!f)&&b.apply(a,[f].concat(e))}}function n(b,c,d){return function(e){e=w(e||((this.ownerDocument||this.document||this).parentWindow||a).event);return c.apply(b,[e].concat(d))}}function m(a,b,c,d,e){a[f]?a[d?f:h](b,c,!1):a[g]&&(e&&d&&(a["_on"+e]=a["_on"+e]||0),a[d?g:i]("on"+b,c))}function l(a){return a._uid=a._uid||b++}function k(a){var b=l(a);return c[b]=c[b]||{}}function j(a,b){var c=b.parentNode;while(c!=null){if(c==a)return!0;c=c.parentNode}}var b=1,c={},d={},e=/over|out/,f="addEventListener",g="attachEvent",h="removeEventListener",i="detachEvent";w.preventDefault=function(){this.returnValue=!1},w.stopPropagation=function(){this.cancelBubble=!0};var x="click,dblclick,mouseup,mousedown,contextmenu,mousewheel,DOMMouseScroll,mouseover,mouseout,mousemove,selectstart,selectend,keydown,keypress,keyup,orientationchange,touchstart,touchmove,touchend,touchcancel,gesturestart,gesturechange,gestureend,focus,blur,change,reset,select,submit,load,unload,beforeunload,resize,move,DOMContentLoaded,readystatechange,"+"error,abort,scroll".split(","),z={mouseenter:{base:"mouseover",condition:y},mouseleave:{base:"mouseout",condition:y},mousewheel:{base:/Firefox/.test(navigator.userAgent)?"DOMMouseScroll":"mousewheel"}},A={add:s,remove:t,clone:v,fire:u},B=function(a){var b=t(a)._uid;b&&(delete d[b],delete c[b])};a[g]&&s(a,"unload",function(){for(var b in d)d.hasOwnProperty(b)&&B(d[b]);a.CollectGarbage&&CollectGarbage()});var C=a.bean;A.noConflict=function(){a.bean=C;return this},typeof module!="undefined"&&module.exports?module.exports=A:a.bean=A}(this)